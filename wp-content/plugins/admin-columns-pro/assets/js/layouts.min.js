jQuery(document).ready(function(d){var e=d(".ac-admin");if(!e.length){return}var f=e.find(".sidebox.layouts");if(f.hasClass("events-binded")){return}f.addClass("events-binded");f.find("a.add-new").click(function(a){a.preventDefault();d(this).toggleClass("open").closest(".layouts").find(".new").slideToggle()});f.find(".new form").on("submit",function(a){a.preventDefault();$name=d(this).find(".row.name");if(!$name.find("input").val()){$name.addClass("save-error");return}d(this).unbind("submit").submit()});f.find("select.roles").each(function(){d(this).select2({placeholder:acp_layouts.roles}).on("select2:select",function(a){d(this).select2("open")}).on("select2:open",function(a){setTimeout(function(){d(".select2-container.select2-container--open .select2-dropdown li[role=group]").each(function(){if(d(this).find("li[aria-selected=false]").length>0){d(this).show()}else{d(this).hide()}})},1)})});f.find(".layout .head").click(function(b){b.preventDefault();var a=d(this).closest(".layout");a.toggleClass("open").find(".body").slideToggle(200)});f.find(".layout .head a, .layout .head input").click(function(a){a.stopPropagation()});f.find("input.name").bind("keyup change",function(){var a=d(this).val();var c=d(this).closest(".layout").data("screen");if(!a.trim()){a=d(this).data("value")}d(this).closest(".ac-admin").find('.layout-selector li[data-screen="'+c+'"] a').text(a);var b=d(this).closest(".layout").find(".head .title").text(a)});f.find(".layout").each(function(a){var c=d(this).closest(".layouts").data("type");var b=d(this).data("screen");d(this).ac_update_layout(c,b)});f.find("select.users").select2({placeholder:acp_layouts.users,multiple:true,minimumInputLength:1,ajax:{type:"POST",url:ajaxurl,dataType:"json",delay:350,data:function(a){return{action:"acp_layout_get_users",_ajax_nonce:acp_layouts._nonce,search:a.term}},processResults:function(a){if(a){if(a.success&&a.data){return{results:a.data}}}return{results:[]}},cache:true}});d(document).bind("cac_update",function(a,b){d(b).find(".layout input.save").trigger("click")})});jQuery.fn.ac_update_layout=function(f,e){var g=jQuery(this);var h=g.find(".save");h.click(function(b){b.preventDefault();g.addClass("loading");var a=g.find("input.name");var c=jQuery(this).attr("disabled","disabled");g.find(".row.name").removeClass("save-error");jQuery.post(ajaxurl,{action:"acp_update_layout",_ajax_nonce:acp_layouts._nonce,list_screen:f,data:g.find("form").serialize()},function(d){if(d){if(d.success){a.data("value",a.val());g.find(".save-message").slideDown().delay(1000).slideUp();g.find(".title-div span.description").text(d.data.title_description)}else{if(d.data){if("empty-name"===d.data){g.addClass("open").find(".body").slideDown().find(".row.name").addClass("save-error")}}}}else{}},"json").fail(function(d){}).always(function(){c.removeAttr("disabled");g.removeClass("loading")})});g.find("input").keypress(function(a){if(13===a.which){h.trigger("click")}})};